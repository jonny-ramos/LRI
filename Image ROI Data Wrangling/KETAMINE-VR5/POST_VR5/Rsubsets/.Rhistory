f
### ANOVAs
# 3way ANOVA: reactivation x treatment x PNNs (2 x 2 x 2) in cFos high (quartile split)
PV.cFos.lm <- lm(norm_adjusted_intensity ~ treat_factor*react_factor*dummy_WFA_factor, contrasts = list(treat_factor='contr.sum', react_factor='contr.sum', dummy_WFA_factor='contr.sum'), data=PV.cFos.highlow[PV.cFos.highlow$quartile_factor == 'q4',])
PV.cFos.aov <- car::Anova(PV.cFos.lm, type=3)
print(PV.cFos.aov)
# 3way ANOVA: reactivation x treatment x PNNs (2 x 2 x 2) in cFos high (quartile split)
PV.cFos.lm <- lm(norm_adjusted_intensity ~ treat_factor*react_factor*dummy_WFA_factor, contrasts = list(treat_factor='contr.sum', react_factor='contr.sum', dummy_WFA_factor='contr.sum'), data=PV.cFos.highlow[PV.cFos.highlow$quartile_factor == 'q1',])
PV.cFos.aov <- car::Anova(PV.cFos.lm, type=3)
print(PV.cFos.aov)
f <- ggplot(PV.cFos.highlow[PV.cFos.highlow$quartile_factor == 'q4',], aes(x=dummy_WFA_factor, y=norm_adjusted_intensity, color='treatment')) +
geom_boxplot()
f
### ANOVAs
# 3way ANOVA: reactivation x treatment x PNNs (2 x 2 x 2) in cFos high (quartile split)
PV.cFos.lm <- lm(norm_adjusted_intensity ~ treat_factor*react_factor*dummy_WFA_factor, contrasts = list(treat_factor='contr.sum', react_factor='contr.sum', dummy_WFA_factor='contr.sum'), data=PV.cFos.highlow[PV.cFos.highlow$quartile_factor == 'q4',])
PV.cFos.aov <- car::Anova(PV.cFos.lm, type=3)
print(PV.cFos.aov)
# 3way ANOVA: reactivation x treatment x PNNs (2 x 2 x 2) in cFos high (quartile split)
PV.cFos.lm <- lm(norm_adjusted_intensity ~ treat_factor*react_factor*dummy_WFA_factor, contrasts = list(treat_factor='contr.sum', react_factor='contr.sum', dummy_WFA_factor='contr.sum'), data=PV.cFos.highlow[PV.cFos.highlow$quartile_factor == 'q1',])
PV.cFos.aov <- car::Anova(PV.cFos.lm, type=3)
print(PV.cFos.aov)
f <- ggplot(PV.cFos.highlow[PV.cFos.highlow$quartile_factor == 'q4',], aes(x=dummy_WFA_factor, y=norm_adjusted_intensity, color=treatment)) +
geom_boxplot()
f
### ANOVAs
# 3way ANOVA: reactivation x treatment x PNNs (2 x 2 x 2) in cFos high (quartile split)
PV.cFos.lm <- lm(norm_adjusted_intensity ~ treat_factor*react_factor*dummy_WFA_factor, contrasts = list(treat_factor='contr.sum', react_factor='contr.sum', dummy_WFA_factor='contr.sum'), data=PV.cFos.highlow[PV.cFos.highlow$quartile_factor == 'q4',])
PV.cFos.aov <- car::Anova(PV.cFos.lm, type=3)
print(PV.cFos.aov)
# 3way ANOVA: reactivation x treatment x PNNs (2 x 2 x 2) in cFos high (quartile split)
PV.cFos.lm <- lm(norm_adjusted_intensity ~ treat_factor*react_factor*dummy_WFA_factor, contrasts = list(treat_factor='contr.sum', react_factor='contr.sum', dummy_WFA_factor='contr.sum'), data=PV.cFos.highlow[PV.cFos.highlow$quartile_factor == 'q1',])
PV.cFos.aov <- car::Anova(PV.cFos.lm, type=3)
print(PV.cFos.aov)
f <- ggplot(PV.cFos.highlow[PV.cFos.highlow$quartile_factor == 'q4',], aes(x=dummy_WFA_factor, y=norm_adjusted_intensity)) +
geom_boxplot(aes(fill=treatment))
f
### ANOVAs
# 3way ANOVA: reactivation x treatment x PNNs (2 x 2 x 2) in cFos high (quartile split)
PV.cFos.lm <- lm(norm_adjusted_intensity ~ treat_factor*react_factor*dummy_WFA_factor, contrasts = list(treat_factor='contr.sum', react_factor='contr.sum', dummy_WFA_factor='contr.sum'), data=PV.cFos.highlow[PV.cFos.highlow$quartile_factor == 'q4',])
PV.cFos.aov <- car::Anova(PV.cFos.lm, type=3)
print(PV.cFos.aov)
# 3way ANOVA: reactivation x treatment x PNNs (2 x 2 x 2) in cFos high (quartile split)
PV.cFos.lm <- lm(norm_adjusted_intensity ~ treat_factor*react_factor*dummy_WFA_factor, contrasts = list(treat_factor='contr.sum', react_factor='contr.sum', dummy_WFA_factor='contr.sum'), data=PV.cFos.highlow[PV.cFos.highlow$quartile_factor == 'q1',])
PV.cFos.aov <- car::Anova(PV.cFos.lm, type=3)
print(PV.cFos.aov)
f <- ggplot(PV.cFos.highlow[PV.cFos.highlow$quartile_factor == 'q4',], aes(x=dummy_WFA_factor, y=norm_adjusted_intensity)) +
geom_boxplot(aes(fill=treatment, alpha=0.5))
f
### ANOVAs
# 3way ANOVA: reactivation x treatment x PNNs (2 x 2 x 2) in cFos high (quartile split)
PV.cFos.lm <- lm(norm_adjusted_intensity ~ treat_factor*react_factor*dummy_WFA_factor, contrasts = list(treat_factor='contr.sum', react_factor='contr.sum', dummy_WFA_factor='contr.sum'), data=PV.cFos.highlow[PV.cFos.highlow$quartile_factor == 'q4',])
PV.cFos.aov <- car::Anova(PV.cFos.lm, type=3)
print(PV.cFos.aov)
# 3way ANOVA: reactivation x treatment x PNNs (2 x 2 x 2) in cFos high (quartile split)
PV.cFos.lm <- lm(norm_adjusted_intensity ~ treat_factor*react_factor*dummy_WFA_factor, contrasts = list(treat_factor='contr.sum', react_factor='contr.sum', dummy_WFA_factor='contr.sum'), data=PV.cFos.highlow[PV.cFos.highlow$quartile_factor == 'q1',])
PV.cFos.aov <- car::Anova(PV.cFos.lm, type=3)
print(PV.cFos.aov)
f <- ggplot(PV.cFos.highlow[PV.cFos.highlow$quartile_factor == 'q4',], aes(x=dummy_WFA_factor, y=norm_adjusted_intensity)) +
geom_boxplot(aes(fill=treatment, alpha=0.5))
f
g <- ggplot(PV.cFos.highlow[PV.cFos.highlow$quartile_factor == 'q1',], aes(x=dummy_WFA_factor, y=norm_adjusted_intensity)) +
geom_boxplot(aes(fill=treatment, alpha=0.5))
g
library(ggplot2)
library(ggpubr)
library(car)
library(emmeans)
library(stringr)
library(rstatix)
l3d <- read.csv('PRE-VR5_Last3Days_Acquisition.csv', sep = ',', header = TRUE)
l3d$day_factor <- as.factor(l3d$Day)
l3d$react_factor <- as.factor(l3d$React)
l3d$treat_factor <- as.factor(l3d$Treat)
l3d$rat_factor <- as.factor(l3d$Rat_n)
str(l3d)
res.aov <- anova_test(
data = l3d, dv = ALP, wid = rat_factor,
within = c(day_factor), between = c(treat_factor, react_factor)
)
get_anova_table(res.aov, correction = 'GG')
res.aov
res.aov <- anova_test(
data = l3d, dv = ILP, wid = rat_factor,
within = c(day_factor), between = c(treat_factor, react_factor)
)
get_anova_table(res.aov, correction = 'GG')
res.aov
res.aov <- anova_test(
data = l3d, dv = Rewards, wid = rat_factor,
within = c(day_factor), between = c(treat_factor, react_factor)
)
get_anova_table(res.aov, correction = 'GG')
res.aov
library(ggplot2)
library(ggpubr)
library(car)
library(emmeans)
library(stringr)
require(gridExtra)
### ANOVAs
# 3way ANOVA: reactivation x treatment x PNNs (2 x 2 x 2) in cFos high (quartile split)
PV.cFos.lm <- lm(norm_adjusted_intensity ~ treat_factor*react_factor*dummy_WFA_factor, contrasts = list(treat_factor='contr.sum', react_factor='contr.sum', dummy_WFA_factor='contr.sum'), data=PV.cFos.highlow[PV.cFos.highlow$quartile_factor == 'q4',])
PV.cFos.aov <- car::Anova(PV.cFos.lm, type=3)
print(PV.cFos.aov)
# 3way ANOVA: reactivation x treatment x PNNs (2 x 2 x 2) in cFos high (quartile split)
PV.cFos.lm <- lm(norm_adjusted_intensity ~ treat_factor*react_factor*dummy_WFA_factor, contrasts = list(treat_factor='contr.sum', react_factor='contr.sum', dummy_WFA_factor='contr.sum'), data=PV.cFos.highlow[PV.cFos.highlow$quartile_factor == 'q1',])
PV.cFos.aov <- car::Anova(PV.cFos.lm, type=3)
print(PV.cFos.aov)
f <- ggplot(PV.cFos.highlow[PV.cFos.highlow$quartile_factor == 'q4',], aes(x=dummy_WFA_factor, y=norm_adjusted_intensity)) +
geom_boxplot(aes(fill=treatment, alpha=0.5))
g <- ggplot(PV.cFos.highlow[PV.cFos.highlow$quartile_factor == 'q1',], aes(x=dummy_WFA_factor, y=norm_adjusted_intensity)) +
geom_boxplot(aes(fill=treatment, alpha=0.5))
grid.arrange(f, g, nrow=2)
### ANOVAs
# 3way ANOVA: reactivation x treatment x PNNs (2 x 2 x 2) in cFos high (quartile split)
PV.cFos.lm <- lm(norm_adjusted_intensity ~ treat_factor*react_factor*dummy_WFA_factor, contrasts = list(treat_factor='contr.sum', react_factor='contr.sum', dummy_WFA_factor='contr.sum'), data=PV.cFos.highlow[PV.cFos.highlow$quartile_factor == 'q4',])
PV.cFos.aov <- car::Anova(PV.cFos.lm, type=3)
print(PV.cFos.aov)
# 3way ANOVA: reactivation x treatment x PNNs (2 x 2 x 2) in cFos high (quartile split)
PV.cFos.lm <- lm(norm_adjusted_intensity ~ treat_factor*react_factor*dummy_WFA_factor, contrasts = list(treat_factor='contr.sum', react_factor='contr.sum', dummy_WFA_factor='contr.sum'), data=PV.cFos.highlow[PV.cFos.highlow$quartile_factor == 'q1',])
PV.cFos.aov <- car::Anova(PV.cFos.lm, type=3)
print(PV.cFos.aov)
f <- ggplot(PV.cFos.highlow[PV.cFos.highlow$quartile_factor == 'q4',], aes(x=dummy_WFA_factor, y=norm_adjusted_intensity)) +
geom_boxplot(aes(fill=treatment, alpha=0.5))
g <- ggplot(PV.cFos.highlow[PV.cFos.highlow$quartile_factor == 'q1',], aes(x=dummy_WFA_factor, y=norm_adjusted_intensity)) +
geom_boxplot(aes(fill=treatment, alpha=0.5))
grid.arrange(f, g, nrow=2)
### ANOVAs
# 3way ANOVA: reactivation x treatment x PNNs (2 x 2 x 2) in cFos high (quartile split)
PV.cFos.lm <- lm(norm_adjusted_intensity ~ treat_factor*react_factor*dummy_WFA_factor, contrasts = list(treat_factor='contr.sum', react_factor='contr.sum', dummy_WFA_factor='contr.sum'), data=PV.cFos.highlow[PV.cFos.highlow$quartile_factor == 'q4',])
PV.cFos.aov <- car::Anova(PV.cFos.lm, type=3)
print(PV.cFos.aov)
# 3way ANOVA: reactivation x treatment x PNNs (2 x 2 x 2) in cFos high (quartile split)
PV.cFos.lm <- lm(norm_adjusted_intensity ~ treat_factor*react_factor*dummy_WFA_factor, contrasts = list(treat_factor='contr.sum', react_factor='contr.sum', dummy_WFA_factor='contr.sum'), data=PV.cFos.highlow[PV.cFos.highlow$quartile_factor == 'q1',])
PV.cFos.aov <- car::Anova(PV.cFos.lm, type=3)
print(PV.cFos.aov)
f <- ggplot(PV.cFos.highlow[PV.cFos.highlow$quartile_factor == 'q4',], aes(x=dummy_WFA_factor, y=norm_adjusted_intensity)) +
geom_boxplot(aes(fill=treatment, alpha=0.5))
g <- ggplot(PV.cFos.highlow[PV.cFos.highlow$quartile_factor == 'q1',], aes(x=dummy_WFA_factor, y=norm_adjusted_intensity)) +
geom_boxplot(aes(fill=treatment, alpha=0.5))
grid.arrange(f, g, nrow=2)
### ANOVAs
# 3way ANOVA: reactivation x treatment x PNNs (2 x 2 x 2) in cFos high (quartile split)
PV.cFos.lm <- lm(norm_adjusted_intensity ~ treat_factor*react_factor*dummy_WFA_factor, contrasts = list(treat_factor='contr.sum', react_factor='contr.sum', dummy_WFA_factor='contr.sum'), data=PV.cFos.highlow[PV.cFos.highlow$quartile_factor == 'q4',])
PV.cFos.aov <- car::Anova(PV.cFos.lm, type=3)
print(PV.cFos.aov)
# 3way ANOVA: reactivation x treatment x PNNs (2 x 2 x 2) in cFos high (quartile split)
PV.cFos.lm <- lm(norm_adjusted_intensity ~ treat_factor*react_factor*dummy_WFA_factor, contrasts = list(treat_factor='contr.sum', react_factor='contr.sum', dummy_WFA_factor='contr.sum'), data=PV.cFos.highlow[PV.cFos.highlow$quartile_factor == 'q1',])
PV.cFos.aov <- car::Anova(PV.cFos.lm, type=3)
print(PV.cFos.aov)
f <- ggplot(PV.cFos.highlow[PV.cFos.highlow$quartile_factor == 'q4',], aes(x=dummy_WFA_factor, y=norm_adjusted_intensity)) +
geom_boxplot(aes(fill=treatment, alpha=0.5))
g <- ggplot(PV.cFos.highlow[PV.cFos.highlow$quartile_factor == 'q1',], aes(x=dummy_WFA_factor, y=norm_adjusted_intensity)) +
geom_boxplot(aes(fill=treatment, alpha=0.5))
grid.arrange(f, g, nrow=2)
### ANOVAs
# 3way ANOVA: reactivation x treatment x PNNs (2 x 2 x 2) in cFos high (quartile split)
PV.cFos.lm <- lm(norm_adjusted_intensity ~ treat_factor*react_factor*dummy_WFA_factor, contrasts = list(treat_factor='contr.sum', react_factor='contr.sum', dummy_WFA_factor='contr.sum'), data=PV.cFos.highlow[PV.cFos.highlow$quartile_factor == 'q4',])
PV.cFos.aov <- car::Anova(PV.cFos.lm, type=3)
print(PV.cFos.aov)
# 3way ANOVA: reactivation x treatment x PNNs (2 x 2 x 2) in cFos high (quartile split)
PV.cFos.lm <- lm(norm_adjusted_intensity ~ treat_factor*react_factor*dummy_WFA_factor, contrasts = list(treat_factor='contr.sum', react_factor='contr.sum', dummy_WFA_factor='contr.sum'), data=PV.cFos.highlow[PV.cFos.highlow$quartile_factor == 'q1',])
PV.cFos.aov <- car::Anova(PV.cFos.lm, type=3)
print(PV.cFos.aov)
f <- ggplot(PV.cFos.highlow[PV.cFos.highlow$quartile_factor == 'q4',], aes(x=dummy_WFA_factor, y=norm_adjusted_intensity)) +
geom_boxplot(aes(fill=treatment, alpha=0.5))
g <- ggplot(PV.cFos.highlow[PV.cFos.highlow$quartile_factor == 'q1',], aes(x=dummy_WFA_factor, y=norm_adjusted_intensity)) +
geom_boxplot(aes(fill=treatment, alpha=0.5))
grid.arrange(f, g, nrow=2)
### ANOVAs
# 3way ANOVA: reactivation x treatment x PNNs (2 x 2 x 2) in cFos high (quartile split)
PV.cFos.lm <- lm(norm_adjusted_intensity ~ treat_factor*react_factor*dummy_WFA_factor, contrasts = list(treat_factor='contr.sum', react_factor='contr.sum', dummy_WFA_factor='contr.sum'), data=PV.cFos.highlow[PV.cFos.highlow$quartile_factor == 'q4',])
PV.cFos.aov <- car::Anova(PV.cFos.lm, type=3)
print(PV.cFos.aov)
# 3way ANOVA: reactivation x treatment x PNNs (2 x 2 x 2) in cFos high (quartile split)
PV.cFos.lm <- lm(norm_adjusted_intensity ~ treat_factor*react_factor*dummy_WFA_factor, contrasts = list(treat_factor='contr.sum', react_factor='contr.sum', dummy_WFA_factor='contr.sum'), data=PV.cFos.highlow[PV.cFos.highlow$quartile_factor == 'q1',])
PV.cFos.aov <- car::Anova(PV.cFos.lm, type=3)
print(PV.cFos.aov)
f <- ggplot(PV.cFos.highlow[PV.cFos.highlow$quartile_factor == 'q4',], aes(x=dummy_WFA_factor, y=norm_adjusted_intensity)) +
geom_boxplot(aes(fill=treatment, alpha=0.5))
g <- ggplot(PV.cFos.highlow[PV.cFos.highlow$quartile_factor == 'q4',], aes(x=dummy_WFA_factor, y=norm_adjusted_intensity)) +
geom_boxplot(aes(fill=treatment, alpha=0.5))
grid.arrange(f, g, nrow=2)
### ANOVAs
# 3way ANOVA: reactivation x treatment x PNNs (2 x 2 x 2) in cFos high (quartile split)
PV.cFos.lm <- lm(norm_adjusted_intensity ~ treat_factor*react_factor*dummy_WFA_factor, contrasts = list(treat_factor='contr.sum', react_factor='contr.sum', dummy_WFA_factor='contr.sum'), data=PV.cFos.highlow[PV.cFos.highlow$quartile_factor == 'q1',])
PV.cFos.aov <- car::Anova(PV.cFos.lm, type=3)
print(PV.cFos.aov)
f <- ggplot(PV.cFos.highlow[PV.cFos.highlow$quartile_factor == 'q1',], aes(x=dummy_WFA_factor, y=norm_adjusted_intensity)) +
geom_boxplot(aes(fill=treatment, alpha=0.5))
g <- ggplot(PV.cFos.highlow[PV.cFos.highlow$quartile_factor == 'q1',], aes(x=dummy_WFA_factor, y=norm_adjusted_intensity)) +
geom_boxplot(aes(fill=treatment, alpha=0.5))
grid.arrange(f, g, nrow=2)
PV.cFos <- read.csv('KET-VR5_PV_split_on_cFos_NORM.csv')
PV.cFos$treat_factor <- as.factor(PV.cFos$treat)
PV.cFos$react_factor <- as.factor(PV.cFos$react)
PV.cFos$react_treat_factor <- as.factor(PV.cFos$treatment)
PV.cFos$cFos_bin_factor <- as.factor(PV.cFos$cFos_bin)
PV.cFos$dummy_WFA_factor <- as.factor(PV.cFos$dummy_WFA)
# slicing out only the top and the bottom quartiles
PV.cFos.high <- PV.cFos[PV.cFos$quartile == 'q4',]
PV.cFos.low <- PV.cFos[PV.cFos$quartile == 'q1',]
PV.cFos.highlow <- rbind(PV.cFos.high, PV.cFos.low)
PV.cFos.highlow$quartile_factor <- as.factor(PV.cFos.highlow$quartile)
### ANOVAs
# 3way ANOVA: reactivation x treatment x quartile (2 x 2 x 2)
PV.cFos.lm <- lm(norm_adjusted_intensity ~ treat_factor*react_factor*cFos_bin_factor, contrasts = list(treat_factor='contr.sum', react_factor='contr.sum', cFos_bin_factor='contr.sum'), data=PV.cFos)
PV.cFos.aov <- car::Anova(PV.cFos.lm, type=3)
print(PV.cFos.aov)
f <- ggplot(PV.cFos.highlow, aes(x=cFos_bin_factor, y=norm_adjusted_intensity)) +
geom_boxplot(aes(fill=treatment, alpha=0.5))
print('PV with cFos high (above median)')
eda_anova(PV.cFos[PV.cFos$cFos_bin == 'cfos_high',], qual=TRUE, quant=FALSE)
print('PV with cFos low (below median)')
eda_anova(PV.cFos[PV.cFos$cFos_bin == 'cfos_low',], qual=TRUE, quant=FALSE)
PV.cFos <- read.csv('KET-VR5_PV_split_on_cFos_NORM.csv')
PV.cFos$treat_factor <- as.factor(PV.cFos$treat)
PV.cFos$react_factor <- as.factor(PV.cFos$react)
PV.cFos$react_treat_factor <- as.factor(PV.cFos$treatment)
PV.cFos$cFos_bin_factor <- as.factor(PV.cFos$cFos_bin)
PV.cFos$dummy_WFA_factor <- as.factor(PV.cFos$dummy_WFA)
# slicing out only the top and the bottom quartiles
PV.cFos.high <- PV.cFos[PV.cFos$quartile == 'q4',]
PV.cFos.low <- PV.cFos[PV.cFos$quartile == 'q1',]
PV.cFos.highlow <- rbind(PV.cFos.high, PV.cFos.low)
PV.cFos.highlow$quartile_factor <- as.factor(PV.cFos.highlow$quartile)
### ANOVAs
# 3way ANOVA: reactivation x treatment x quartile (2 x 2 x 2)
PV.cFos.lm <- lm(norm_adjusted_intensity ~ treat_factor*react_factor*cFos_bin_factor, contrasts = list(treat_factor='contr.sum', react_factor='contr.sum', cFos_bin_factor='contr.sum'), data=PV.cFos)
PV.cFos.aov <- car::Anova(PV.cFos.lm, type=3)
print(PV.cFos.aov)
f <- ggplot(PV.cFos.highlow, aes(x=cFos_bin_factor, y=norm_adjusted_intensity)) +
geom_boxplot(aes(fill=treatment, alpha=0.5))
f
print('PV with cFos high (above median)')
eda_anova(PV.cFos[PV.cFos$cFos_bin == 'cfos_high',], qual=TRUE, quant=FALSE)
print('PV with cFos low (below median)')
eda_anova(PV.cFos[PV.cFos$cFos_bin == 'cfos_low',], qual=TRUE, quant=FALSE)
Sidak <- function(pvals)
# takes a vector of p-values and corrects p-values according to
# Sidaks method for multiple comparisons (1967)
#
# Jonathan Ramos 3/12/2024
{
adjusted <- c()
j <- length(pvals)
for (i in 1:j){
adj_p <- 1-(1-pvals[i])^j
adjusted <- c(adjusted, adj_p)
}
return(adjusted)
}
eda_anova <- function(df, qual=TRUE, quant=TRUE)
# takes a filname, loads data from csv; data 4 columns:
# react_treat, react, treat, and norm_int (response var)
# react_treat is just react and treat in one string separated by "_"
# builds factor cols for categorical cols (norm_int is numeric, all others are categorical)
# then performs the following tasks:
# checks assumptions of normality with qqplot and shapiro wilk tests
# checks assumptions of equal variances with box plot and levene test
# performs 2way ANOVA (2 by 2, react by treat)
# performs post hoc pairwise comparisons (emmeans of levels of react by treat
# and emmeans of levels of treat by react)
# prints out all statistical test results and returns plot objects
# for the two plots: the qqplots and the box plots
#
# Jonathan Ramos 3/12/2024
{
### check assumption of normality
# quantitative assessment
if (quant) {
print(tapply(df$norm_adjusted_intensity, df$react_treat_factor, shapiro.test))
}
# qualitative assessment
if (qual) {
g <- ggqqplot(df, x="norm_adjusted_intensity", facet.by=c("treat_factor", "react_factor"))
}
### check assumption of equal variances
# quantitative assessment
if (quant) {
print(leveneTest(y = df$norm_adjusted_intensity, group=df$react_treat_factor, center='mean'))
}
# qualitative assessment
if (qual) {
f <- ggplot(df, aes(x=treat_factor, y=norm_adjusted_intensity)) + geom_boxplot(aes(fill=treat_factor), alpha=0.5) +
#geom_dotplot(binaxis = "y", stackdir = "center", dotsize=0.5) +
facet_wrap(~react_factor) +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))
}
# run the ANOVA, display summary
df.lm <- lm(norm_adjusted_intensity ~ treat_factor + react_factor + treat_factor*react_factor, contrasts=list(treat_factor='contr.sum', react_factor ='contr.sum'), data=df)
df.III.aov <- car::Anova(df.lm, type = 3)
print(df.III.aov)
# post hoc pairwise comparisons
emm <- emmeans(df.lm, ~ treat_factor * react_factor)
p1 <- pairs(emm, simple="treat_factor", adjust="tukey")
p2 <- pairs(emm, simple="react_factor", adjust="tukey")
# add col to summary dataframe containing sidak adjusted p-values
adjusted_p.value1 <- Sidak(summary(p1, adjust="tukey")$p.value)
s1 <- summary(p1)
s1['adjusted_p.value'] <- adjusted_p.value1
adjusted_p.value2 <- Sidak(summary(p2, adjust="tukey")$p.value)
s2 <- summary(p2)
s2['adjusted_p.value'] <- adjusted_p.value2
# display results
print(s1)
print(s2)
if (qual) {
return(list(g, f))
}
}
PV.cFos <- read.csv('KET-VR5_PV_split_on_cFos_NORM.csv')
PV.cFos$treat_factor <- as.factor(PV.cFos$treat)
PV.cFos$react_factor <- as.factor(PV.cFos$react)
PV.cFos$react_treat_factor <- as.factor(PV.cFos$treatment)
PV.cFos$cFos_bin_factor <- as.factor(PV.cFos$cFos_bin)
PV.cFos$dummy_WFA_factor <- as.factor(PV.cFos$dummy_WFA)
# slicing out only the top and the bottom quartiles
PV.cFos.high <- PV.cFos[PV.cFos$quartile == 'q4',]
PV.cFos.low <- PV.cFos[PV.cFos$quartile == 'q1',]
PV.cFos.highlow <- rbind(PV.cFos.high, PV.cFos.low)
PV.cFos.highlow$quartile_factor <- as.factor(PV.cFos.highlow$quartile)
### ANOVAs
# 3way ANOVA: reactivation x treatment x quartile (2 x 2 x 2)
PV.cFos.lm <- lm(norm_adjusted_intensity ~ treat_factor*react_factor*cFos_bin_factor, contrasts = list(treat_factor='contr.sum', react_factor='contr.sum', cFos_bin_factor='contr.sum'), data=PV.cFos)
PV.cFos.aov <- car::Anova(PV.cFos.lm, type=3)
print(PV.cFos.aov)
f <- ggplot(PV.cFos.highlow, aes(x=cFos_bin_factor, y=norm_adjusted_intensity)) +
geom_boxplot(aes(fill=treatment, alpha=0.5)) +
ggtitle('title')
f
print('PV with cFos high (above median)')
eda_anova(PV.cFos[PV.cFos$cFos_bin == 'cfos_high',], qual=TRUE, quant=FALSE)
print('PV with cFos low (below median)')
eda_anova(PV.cFos[PV.cFos$cFos_bin == 'cfos_low',], qual=TRUE, quant=FALSE)
PV.cFos <- read.csv('KET-VR5_PV_split_on_cFos_NORM.csv')
PV.cFos$treat_factor <- as.factor(PV.cFos$treat)
PV.cFos$react_factor <- as.factor(PV.cFos$react)
PV.cFos$react_treat_factor <- as.factor(PV.cFos$treatment)
PV.cFos$cFos_bin_factor <- as.factor(PV.cFos$cFos_bin)
PV.cFos$dummy_WFA_factor <- as.factor(PV.cFos$dummy_WFA)
# slicing out only the top and the bottom quartiles
PV.cFos.high <- PV.cFos[PV.cFos$quartile == 'q4',]
PV.cFos.low <- PV.cFos[PV.cFos$quartile == 'q1',]
PV.cFos.highlow <- rbind(PV.cFos.high, PV.cFos.low)
PV.cFos.highlow$quartile_factor <- as.factor(PV.cFos.highlow$quartile)
### ANOVAs
# 3way ANOVA: reactivation x treatment x quartile (2 x 2 x 2)
PV.cFos.lm <- lm(norm_adjusted_intensity ~ treat_factor*react_factor*cFos_bin_factor, contrasts = list(treat_factor='contr.sum', react_factor='contr.sum', cFos_bin_factor='contr.sum'), data=PV.cFos)
PV.cFos.aov <- car::Anova(PV.cFos.lm, type=3)
print(PV.cFos.aov)
f <- ggplot(PV.cFos, aes(x=cFos_bin_factor, y=norm_adjusted_intensity)) +
geom_boxplot(aes(fill=treatment, alpha=0.5)) +
ggtitle('Norm PV intensity, split on cFos intensity (median)')
f
print('PV with cFos high (above median)')
eda_anova(PV.cFos[PV.cFos$cFos_bin == 'cfos_high',], qual=TRUE, quant=FALSE)
print('PV with cFos low (below median)')
eda_anova(PV.cFos[PV.cFos$cFos_bin == 'cfos_low',], qual=TRUE, quant=FALSE)
# 3way ANOVA: reactivation x treatment x quartile (2 x 2 x 2)
PV.cFos.lm <- lm(norm_adjusted_intensity ~ treat_factor*react_factor*quartile_factor, contrasts = list(treat_factor='contr.sum', react_factor='contr.sum', quartile_factor='contr.sum'), data=PV.cFos.highlow)
PV.cFos.aov <- car::Anova(PV.cFos.lm, type=3)
print(PV.cFos.aov)
f <- ggplot(PV.cFos, aes(x=cFos_bin_factor, y=norm_adjusted_intensity)) +
geom_boxplot(aes(fill=treatment, alpha=0.5)) +
ggtitle('Norm PV intensity, split on cFos intensity (top vs bottom quartile)')
f
print('PV with cFos high (top quartile)')
eda_anova(PV.cFos.high, qual=TRUE, quant=FALSE)
print('PV with cFos low (bottom quartile)')
eda_anova(PV.cFos.low, qual=TRUE, quant=FALSE)
# 3way ANOVA: reactivation x treatment x quartile (2 x 2 x 2)
PV.cFos.lm <- lm(norm_adjusted_intensity ~ treat_factor*react_factor*quartile_factor, contrasts = list(treat_factor='contr.sum', react_factor='contr.sum', quartile_factor='contr.sum'), data=PV.cFos.highlow)
PV.cFos.aov <- car::Anova(PV.cFos.lm, type=3)
print(PV.cFos.aov)
f <- ggplot(PV.cFos.highlow, aes(x=quartile_factor, y=norm_adjusted_intensity)) +
geom_boxplot(aes(fill=treatment, alpha=0.5)) +
ggtitle('Norm PV intensity, split on cFos intensity (top vs bottom quartile)')
f
print('PV with cFos high (top quartile)')
eda_anova(PV.cFos.high, qual=TRUE, quant=FALSE)
print('PV with cFos low (bottom quartile)')
eda_anova(PV.cFos.low, qual=TRUE, quant=FALSE)
PV.cFos <- read.csv('KET-VR5_PV_split_on_cFos_NORM.csv')
PV.cFos$treat_factor <- as.factor(PV.cFos$treat)
PV.cFos$react_factor <- as.factor(PV.cFos$react)
PV.cFos$react_treat_factor <- as.factor(PV.cFos$treatment)
PV.cFos$cFos_bin_factor <- as.factor(PV.cFos$cFos_bin)
PV.cFos$dummy_WFA_factor <- as.factor(PV.cFos$dummy_WFA)
# slicing out only the top and the bottom quartiles
PV.cFos.high <- PV.cFos[PV.cFos$quartile == 'q4',]
PV.cFos.low <- PV.cFos[PV.cFos$quartile == 'q1',]
PV.cFos.highlow <- rbind(PV.cFos.high, PV.cFos.low)
PV.cFos.highlow$quartile_factor <- as.factor(PV.cFos.highlow$quartile)
### ANOVAs
# 3way ANOVA: reactivation x treatment x quartile (2 x 2 x 2)
PV.cFos.lm <- lm(norm_adjusted_intensity ~ treat_factor*react_factor*cFos_bin_factor, contrasts = list(treat_factor='contr.sum', react_factor='contr.sum', cFos_bin_factor='contr.sum'), data=PV.cFos)
PV.cFos.aov <- car::Anova(PV.cFos.lm, type=3)
print(PV.cFos.aov)
f <- ggplot(PV.cFos, aes(x=cFos_bin_factor, y=norm_adjusted_intensity)) +
geom_boxplot(aes(fill=treatment, alpha=0.5)) +
ggtitle('Norm PV intensity, split on cFos intensity (top vs bottom quartile)')
f
print('PV with cFos high (above median)')
eda_anova(PV.cFos[PV.cFos$cFos_bin == 'cfos_high',], qual=TRUE, quant=FALSE)
print('PV with cFos low (below median)')
eda_anova(PV.cFos[PV.cFos$cFos_bin == 'cfos_low',], qual=TRUE, quant=FALSE)
PV.cFos <- read.csv('KET-VR5_PV_split_on_cFos_NORM.csv')
PV.cFos$treat_factor <- as.factor(PV.cFos$treat)
PV.cFos$react_factor <- as.factor(PV.cFos$react)
PV.cFos$react_treat_factor <- as.factor(PV.cFos$treatment)
PV.cFos$cFos_bin_factor <- as.factor(PV.cFos$cFos_bin)
PV.cFos$dummy_WFA_factor <- as.factor(PV.cFos$dummy_WFA)
# slicing out only the top and the bottom quartiles
PV.cFos.high <- PV.cFos[PV.cFos$quartile == 'q4',]
PV.cFos.low <- PV.cFos[PV.cFos$quartile == 'q1',]
PV.cFos.highlow <- rbind(PV.cFos.high, PV.cFos.low)
PV.cFos.highlow$quartile_factor <- as.factor(PV.cFos.highlow$quartile)
### ANOVAs
# 3way ANOVA: reactivation x treatment x quartile (2 x 2 x 2)
PV.cFos.lm <- lm(norm_adjusted_intensity ~ treat_factor*react_factor*cFos_bin_factor, contrasts = list(treat_factor='contr.sum', react_factor='contr.sum', cFos_bin_factor='contr.sum'), data=PV.cFos)
PV.cFos.aov <- car::Anova(PV.cFos.lm, type=3)
print(PV.cFos.aov)
f <- ggplot(PV.cFos, aes(x=cFos_bin_factor, y=norm_adjusted_intensity)) +
geom_boxplot(aes(fill=treatment, alpha=0.5)) +
ggtitle('Norm PV intensity, split on cFos intensity (median)')
f
print('PV with cFos high (above median)')
eda_anova(PV.cFos[PV.cFos$cFos_bin == 'cfos_high',], qual=TRUE, quant=FALSE)
print('PV with cFos low (below median)')
eda_anova(PV.cFos[PV.cFos$cFos_bin == 'cfos_low',], qual=TRUE, quant=FALSE)
# 3way ANOVA: reactivation x treatment x quartile (2 x 2 x 2)
PV.cFos.lm <- lm(norm_adjusted_intensity ~ treat_factor*react_factor*quartile_factor, contrasts = list(treat_factor='contr.sum', react_factor='contr.sum', quartile_factor='contr.sum'), data=PV.cFos.highlow)
PV.cFos.aov <- car::Anova(PV.cFos.lm, type=3)
print(PV.cFos.aov)
f <- ggplot(PV.cFos.highlow, aes(x=quartile_factor, y=norm_adjusted_intensity)) +
geom_boxplot(aes(fill=treatment, alpha=0.5)) +
ggtitle('Norm PV intensity, split on cFos intensity (top vs bottom quartile)')
f
print('PV with cFos high (top quartile)')
eda_anova(PV.cFos.high, qual=TRUE, quant=FALSE)
print('PV with cFos low (bottom quartile)')
eda_anova(PV.cFos.low, qual=TRUE, quant=FALSE)
### ANOVAs
# 3way ANOVA: reactivation x treatment x PNNs (2 x 2 x 2) in cFos high (quartile split)
PV.cFos.lm <- lm(norm_adjusted_intensity ~ treat_factor*react_factor*dummy_WFA_factor, contrasts = list(treat_factor='contr.sum', react_factor='contr.sum', dummy_WFA_factor='contr.sum'), data=PV.cFos.highlow[PV.cFos.highlow$quartile_factor == 'q4',])
PV.cFos.aov <- car::Anova(PV.cFos.lm, type=3)
print(PV.cFos.aov)
# 3way ANOVA: reactivation x treatment x PNNs (2 x 2 x 2) in cFos high (quartile split)
PV.cFos.lm <- lm(norm_adjusted_intensity ~ treat_factor*react_factor*dummy_WFA_factor, contrasts = list(treat_factor='contr.sum', react_factor='contr.sum', dummy_WFA_factor='contr.sum'), data=PV.cFos.highlow[PV.cFos.highlow$quartile_factor == 'q1',])
PV.cFos.aov <- car::Anova(PV.cFos.lm, type=3)
print(PV.cFos.aov)
f <- ggplot(PV.cFos.highlow[PV.cFos.highlow$quartile_factor == 'q4',], aes(x=dummy_WFA_factor, y=norm_adjusted_intensity)) +
geom_boxplot(aes(fill=treatment, alpha=0.5)) +
ggtitle('Norm PV intensity, top quartile cFos intensity, WFA+/-')
g <- ggplot(PV.cFos.highlow[PV.cFos.highlow$quartile_factor == 'q4',], aes(x=dummy_WFA_factor, y=norm_adjusted_intensity)) +
geom_boxplot(aes(fill=treatment, alpha=0.5)) +
ggtitle('Norm PV intensity, bottom quartile cFos intensity, WFA+/-')
grid.arrange(f, g, nrow=2)
### ANOVAs
# 3way ANOVA: reactivation x treatment x PNNs (2 x 2 x 2) in cFos high (quartile split)
PV.cFos.lm <- lm(norm_adjusted_intensity ~ treat_factor*react_factor*dummy_WFA_factor, contrasts = list(treat_factor='contr.sum', react_factor='contr.sum', dummy_WFA_factor='contr.sum'), data=PV.cFos.highlow[PV.cFos.highlow$quartile_factor == 'q4',])
PV.cFos.aov <- car::Anova(PV.cFos.lm, type=3)
print(PV.cFos.aov)
# 3way ANOVA: reactivation x treatment x PNNs (2 x 2 x 2) in cFos high (quartile split)
PV.cFos.lm <- lm(norm_adjusted_intensity ~ treat_factor*react_factor*dummy_WFA_factor, contrasts = list(treat_factor='contr.sum', react_factor='contr.sum', dummy_WFA_factor='contr.sum'), data=PV.cFos.highlow[PV.cFos.highlow$quartile_factor == 'q1',])
PV.cFos.aov <- car::Anova(PV.cFos.lm, type=3)
print(PV.cFos.aov)
f <- ggplot(PV.cFos.highlow[PV.cFos.highlow$quartile_factor == 'q4',], aes(x=dummy_WFA_factor, y=norm_adjusted_intensity)) +
geom_boxplot(aes(fill=treatment, alpha=0.5)) +
ggtitle('Norm PV intensity, top quartile cFos intensity, WFA+/-')
g <- ggplot(PV.cFos.highlow[PV.cFos.highlow$quartile_factor == 'q1',], aes(x=dummy_WFA_factor, y=norm_adjusted_intensity)) +
geom_boxplot(aes(fill=treatment, alpha=0.5)) +
ggtitle('Norm PV intensity, bottom quartile cFos intensity, WFA+/-')
grid.arrange(f, g, nrow=2)
### ANOVAs
# 3way ANOVA: reactivation x treatment x PNNs (2 x 2 x 2) in cFos high (median split)
print('3way ANOVA: reactivation x treatment x PNNs (2 x 2 x 2) in cFos high (median split)')
PV.cFos.lm <- lm(norm_adjusted_intensity ~ treat_factor*react_factor*dummy_WFA_factor, contrasts = list(treat_factor='contr.sum', react_factor='contr.sum', dummy_WFA_factor='contr.sum'), data=PV.cFos[PV.cFos$cFos_bin_factor == 'cfos_high',])
PV.cFos.aov <- car::Anova(PV.cFos.lm, type=3)
print(PV.cFos.aov)
# 3way ANOVA: reactivation x treatment x PNNs (2 x 2 x 2) in cFos low (median split)
print('3way ANOVA: reactivation x treatment x PNNs (2 x 2 x 2) in cFos low (median split)')
PV.cFos.lm <- lm(norm_adjusted_intensity ~ treat_factor*react_factor*dummy_WFA_factor, contrasts = list(treat_factor='contr.sum', react_factor='contr.sum', dummy_WFA_factor='contr.sum'), data=PV.cFos[PV.cFos$cFos_bin_factor == 'cfos_low',])
PV.cFos.aov <- car::Anova(PV.cFos.lm, type=3)
print(PV.cFos.aov)
f <- ggplot(PV.cFos[PV.cFos$cFos_bin_factor == 'cfos_high',], aes(x=dummy_WFA_factor, y=norm_adjusted_intensity)) +
geom_boxplot(aes(fill=treatment, alpha=0.5)) +
ggtitle('Norm PV intensity, cFos_high (median split), WFA+/-')
g <- ggplot(PV.cFos[PV.cFos$cFos_bin_factor == 'cfos_low',], aes(x=dummy_WFA_factor, y=norm_adjusted_intensity)) +
geom_boxplot(aes(fill=treatment, alpha=0.5)) +
ggtitle('Norm PV intensity, cFos_low (median split), WFA+/-')
grid.arrange(f, g, nrow=2)
### ANOVAs
# 3way ANOVA: reactivation x treatment x PNNs (2 x 2 x 2) in cFos high (quartile split)
print('3way ANOVA: reactivation x treatment x PNNs (2 x 2 x 2) in cFos high (quartile split)')
PV.cFos.lm <- lm(norm_adjusted_intensity ~ treat_factor*react_factor*dummy_WFA_factor, contrasts = list(treat_factor='contr.sum', react_factor='contr.sum', dummy_WFA_factor='contr.sum'), data=PV.cFos.highlow[PV.cFos.highlow$quartile_factor == 'q4',])
PV.cFos.aov <- car::Anova(PV.cFos.lm, type=3)
print(PV.cFos.aov)
# 3way ANOVA: reactivation x treatment x PNNs (2 x 2 x 2) in cFos low (quartile split)
print('3way ANOVA: reactivation x treatment x PNNs (2 x 2 x 2) in cFos low (quartile split)')
PV.cFos.lm <- lm(norm_adjusted_intensity ~ treat_factor*react_factor*dummy_WFA_factor, contrasts = list(treat_factor='contr.sum', react_factor='contr.sum', dummy_WFA_factor='contr.sum'), data=PV.cFos.highlow[PV.cFos.highlow$quartile_factor == 'q1',])
PV.cFos.aov <- car::Anova(PV.cFos.lm, type=3)
print(PV.cFos.aov)
f <- ggplot(PV.cFos.highlow[PV.cFos.highlow$quartile_factor == 'q4',], aes(x=dummy_WFA_factor, y=norm_adjusted_intensity)) +
geom_boxplot(aes(fill=treatment, alpha=0.5)) +
ggtitle('Norm PV intensity, top quartile cFos intensity, WFA+/-')
g <- ggplot(PV.cFos.highlow[PV.cFos.highlow$quartile_factor == 'q1',], aes(x=dummy_WFA_factor, y=norm_adjusted_intensity)) +
geom_boxplot(aes(fill=treatment, alpha=0.5)) +
ggtitle('Norm PV intensity, bottom quartile cFos intensity, WFA+/-')
grid.arrange(f, g, nrow=2)
